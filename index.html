<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>متجر وفرنهالك تك - اشتراكاتك الرقمية</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts (Cairo) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- Custom Styles -->
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #000000; /* Black background */
            color: #e5e7eb; /* Lighter gray text */
        }
        .product-card {
            background-color: #1a1a1a; /* Darker card background */
            border: 1px solid #2e2e2e;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.1), 0 4px 6px -2px rgba(16, 185, 129, 0.05);
            border-color: #10b981;
        }
        .btn-primary {
            background-color: #10b981; /* Green Button */
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #059669;
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.5);
        }
        .btn-secondary {
            background-color: #374151;
            transition: all 0.3s ease;
        }
        .btn-secondary:hover {
            background-color: #4b5563;
        }
        .modal-backdrop {
            backdrop-filter: blur(5px);
        }
        /* Loading Spinner */
        .loader {
            border: 4px solid #f3f3f330;
            border-top: 4px solid #10b981;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        #dropdown-arrow {
             transition: transform 0.3s ease;
        }
        #package-options {
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body class="antialiased">

    <div id="app" class="container mx-auto p-4 md:p-8">

        <!-- Header -->
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-2">متجر <span class="text-green-400">وفرنهالك تك</span></h1>
            <p class="text-lg text-gray-400 mb-6">اشتراكاتك الرقمية بأفضل الأسعار</p>
            
        </header>

        <!-- Products Grid -->
        <main id="products-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <!-- Products will be dynamically inserted here -->
        </main>

        <!-- Footer -->
        <footer class="text-center mt-16 text-gray-500">
            <p>&copy; 2024 متجر وفرنهالك تك. جميع الحقوق محفوظة.</p>
        </footer>

    </div>

    <!-- Order Modal -->
    <div id="order-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-backdrop fixed inset-0 bg-black bg-opacity-70" onclick="closeOrderModal()"></div>
        <div class="bg-gray-900 rounded-lg shadow-xl w-11/12 max-w-lg m-4 transform transition-all relative border border-gray-700" onclick="event.stopPropagation()">
            <div class="p-5 border-b border-gray-700 flex justify-between items-center">
                <h2 id="modal-product-title" class="text-2xl font-bold text-white"></h2>
                <button onclick="closeOrderModal()" class="text-gray-400 hover:text-white text-3xl">&times;</button>
            </div>
            <form id="order-form" class="p-5">
                <input type="hidden" id="product-name-input">
                
                <!-- New Package Selector Dropdown -->
                <div class="mb-6">
                    <label class="block mb-3 font-semibold text-gray-200 text-lg">اختر الباقة:</label>
                    <div id="package-dropdown" class="relative">
                        <button type="button" id="package-button" class="w-full p-3 bg-gray-700 border border-gray-600 rounded-md text-white flex justify-between items-center text-right">
                            <span id="selected-package-text" class="truncate"></span>
                             <svg class="w-5 h-5 text-gray-400" id="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                            </svg>
                        </button>
                        <div id="package-options" class="absolute z-10 w-full mt-1 bg-gray-800 border border-gray-600 rounded-md shadow-lg hidden">
                            <!-- Options will be injected by JS -->
                        </div>
                    </div>
                    <input type="hidden" id="selected-package-input" name="package">
                </div>

                <div class="space-y-4">
                    <div><label for="customer-name" class="block mb-1 font-semibold text-gray-300">الاسم</label><input type="text" id="customer-name" class="w-full p-2 bg-gray-800 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-green-500" required></div>
                    <div><label for="customer-phone" class="block mb-1 font-semibold text-gray-300">رقم الواتساب (إجباري)</label><input type="tel" id="customer-phone" placeholder="مثال: 201012345678" class="w-full p-2 bg-gray-800 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-green-500" required></div>
                    <div><label for="customer-email" class="block mb-1 font-semibold text-gray-300">الإيميل (اختياري)</label><input type="email" id="customer-email" placeholder="مطلوب للحسابات الشخصية" class="w-full p-2 bg-gray-800 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-green-500"></div>
                    <div><label for="customer-notes" class="block mb-1 font-semibold text-gray-300">ملاحظات إضافية</label><textarea id="customer-notes" rows="2" class="w-full p-2 bg-gray-800 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-green-500"></textarea></div>
                    <button type="submit" class="w-full btn-primary text-white py-3 rounded-lg text-lg font-bold">إرسال الطلب عبر واتساب</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Gemini AI Helper Modal -->
    <div id="ai-helper-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-backdrop fixed inset-0 bg-black bg-opacity-70" onclick="closeAiHelperModal()"></div>
        <div class="bg-gray-900 rounded-lg shadow-xl w-11/12 max-w-2xl m-4 transform transition-all relative border border-gray-700 flex flex-col" style="max-height: 90vh;">
            <div class="p-5 border-b border-gray-700 flex justify-between items-center">
                <h2 id="ai-modal-title" class="text-2xl font-bold text-white">✨ مساعدك الذكي</h2>
                <button onclick="closeAiHelperModal()" class="text-gray-400 hover:text-white text-3xl">&times;</button>
            </div>
            <div id="ai-modal-content" class="p-6 overflow-y-auto flex-grow">
                <!-- Content will be injected here -->
            </div>
            <div id="ai-modal-loader" class="p-6 flex-grow hidden items-center justify-center flex-col">
                <div class="loader"></div>
                <p class="mt-4 text-green-400">يفكر الذكاء الاصطناعي...</p>
            </div>
            <div id="ai-modal-form-container" class="p-6 border-t border-gray-700">
                <form id="ai-helper-form">
                    <input type="hidden" id="ai-prompt-type">
                    <textarea id="ai-user-prompt" rows="3" class="w-full p-3 bg-gray-800 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="مثال: أنا طالب وأحتاج برنامج لتعديل الفيديوهات وعمل التصاميم بسهولة..."></textarea>
                    <button type="submit" class="w-full mt-4 btn-primary text-white py-3 rounded-lg text-lg font-bold">
                        احصل على توصية
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // --- DATA ---
        const products = [
             {
                id: 'capcut',
                title: '🎬 CapCut Pro',
                image: 'https://placehold.co/600x400/000000/FFFFFF?text=CapCut+Pro',
                features: ['إزالة العلامة المائية', 'استخدام قوالب البرو', 'أدوات الذكاء الاصطناعي', 'تخزين سحابي 1 تيرابايت'],
                packages: [
                    { name: 'شخصي - 1 شهر (ميل جديد)', price: '499 جنيه' },
                    { name: 'شخصي - 12 شهر (عرض)', price: '2800 جنيه' },
                    { name: 'شخصي - 12 شهر (إيميل قديم)', price: '5100 جنيه' }
                ],
                notes: 'لأفضل سعر، استخدم إيميل جديد لم يفعل مسبقًا على CapCut.'
            },
            {
                id: 'chatgpt',
                title: '🔥 ChatGPT & Sora AI',
                image: 'https://placehold.co/600x400/10a37f/FFFFFF?text=ChatGPT+4o',
                features: ['دخول GPT-5', '80 Prompt كل 3 ساعات', 'إنشاء فيديوهات بـ Sora', 'دعم الإضافات (Plugins)'],
                packages: [
                    { name: 'مشترك - 1 شهر', price: '399 جنيه' },
                    { name: 'مشترك - 3 شهور', price: '899 جنيه' },
                    { name: 'مشترك - 12 شهر', price: '2499 جنيه' },
                    { name: 'شخصي خاص - 1 شهر', price: '1000 جنيه' }
                ],
                notes: 'الحسابات المشتركة يتم تسليمها فور الدفع.'
            },
            {
                id: 'adobe',
                title: '🚀 Adobe Creative Cloud',
                image: 'https://placehold.co/600x400/ff0000/FFFFFF?text=Adobe',
                features: ['كل برامج أدوبي', 'تحديثات مستمرة', 'تخزين سحابي', 'يعمل على أجهزتك'],
                packages: [ { name: '6 شهور', price: '1600 جنيه' }, { name: 'سنة', price: '2700 جنيه' } ],
                notes: 'الأسعار قابلة للتغيير، تأكد من السعر قبل الدفع.'
            },
            {
                id: 'midjourney_runway',
                title: '🎥 Midjourney & Runway',
                image: 'https://placehold.co/600x400/7a00ff/FFFFFF?text=AI+Video',
                features: ['توليد فيديوهات غير محدود', 'إزالة العلامات المائية', 'جودة عالية في الإنتاج', 'وصول لأحدث الموديلات'],
                packages: [ { name: 'Midjourney/Runway - 1 شهر', price: 'تبدأ من 799 جنيه' } ],
                notes: 'الحجز بالأسبقية لتكوين المجموعات.'
            },
            { id: 'freepik_dl', title: '🖥 Freepik (تحميل فقط)', image: 'https://placehold.co/600x400/0f73ff/FFFFFF?text=Freepik', features: ['يشمل Freepik وFlaticon', 'دخول مباشر بيوزر وباسورد', 'يعمل على جهاز واحد', 'تحميل 25 ملف يوميًا'], packages: [ { name: 'مشترك - 3 شهور', price: '800 جنيه' }, { name: 'مشترك - 6 شهور', price: '1300 جنيه' }, { name: 'مشترك - 12 شهر', price: '2200 جنيه' }, ], notes: 'هذه الباقة لا تتضمن نقاط الذكاء الاصطناعي (AI).' },
            { id: 'freepik_ai', title: '🤖 Freepik (تحميل و AI)', image: 'https://placehold.co/600x400/ff6e3a/FFFFFF?text=Freepik+AI', features: ['توليد وتعديل لا نهائي للصور', '7000 نقطة AI شهرية', 'تحميل 25 ملف يوميًا', 'يعمل على جهاز واحد'], packages: [ { name: 'مشترك (AI) - 1 شهر', price: '800 جنيه' }, { name: 'فردي Premium - 12 شهر', price: '5400 جنيه' }, { name: 'فردي Premium+ - 12 شهر', price: '13,000 جنيه' } ], notes: 'الاشتراك الفردي يعمل على 3 أجهزة ويشمل نقاط AI أكثر.' },
            { id: 'canva', title: '🎨 Canva Educational (Pro)', image: 'https://placehold.co/600x400/8d33ff/FFFFFF?text=Canva', features: ['تغيير مقاسات التصميم', 'مكتبة ضخمة من القوالب', 'إزالة خلفيات الصور بضغطة', 'تصميم كل شيء بسهولة'], packages: [ { name: 'سنة', price: '250 جنيه' }, { name: '3 سنين', price: '450 جنيه' } ], notes: 'الحل الأمثل لغير المصممين لإنتاج تصاميم احترافية.' },
            { id: 'linkedin', title: '💼 LinkedIn Premium', image: 'https://placehold.co/600x400/0a66c2/FFFFFF?text=LinkedIn', features: ['تفعيل على حسابك الشخصي', 'خصوصية تامة بدعوة خاصة', 'ضمان المدة كاملة'], packages: [ { name: 'Premium Business - 12 شهر', price: '4300 جنيه' }, { name: 'باقات أخرى', price: 'اسأل عن التوفر' } ], notes: 'السعر يتغير يوميًا بسبب قلة التوافر، اسأل قبل الدفع.' },
            { id: 'envato', title: '🔸 Envato Elements', image: 'https://placehold.co/600x400/82b440/FFFFFF?text=Envato', features: ['يشمل כל محتوى الموقع', 'تحميل 50-60 ملف يوميًا', 'دخول مباشر بيوزر وباسورد'], packages: [ { name: 'مشترك - 3 أشهر', price: '699 جنيه' }, { name: 'مشترك - 12 شهر', price: '1600 جنيه' }, { name: 'شخصي (8 أجهزة) - 12 شهر', price: '5900 جنيه' } ], notes: 'خصم خاص للحساب الشخصي في حال طلب أكثر من جهاز.' }
        ];
        const whatsappNumber = "201150580198";

        // --- DOM Elements ---
        const productsGrid = document.getElementById('products-grid');
        const orderModal = document.getElementById('order-modal');
        const aiHelperModal = document.getElementById('ai-helper-modal');
        const orderForm = document.getElementById('order-form');
        const modalProductTitle = document.getElementById('modal-product-title');
        const productNameInput = document.getElementById('product-name-input');
        
        const aiModalTitle = document.getElementById('ai-modal-title');
        const aiModalContent = document.getElementById('ai-modal-content');
        const aiModalLoader = document.getElementById('ai-modal-loader');
        const aiModalFormContainer = document.getElementById('ai-modal-form-container');
        const aiHelperForm = document.getElementById('ai-helper-form');
        const aiPromptTypeInput = document.getElementById('ai-prompt-type');
        const aiUserPromptTextarea = document.getElementById('ai-user-prompt');

        // --- GEMINI API FUNCTION ---
        async function callGeminiAPI(prompt, systemPrompt = "") {
            const apiKey = ""; // Left empty as per instructions
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            const payload = { contents: [{ parts: [{ text: prompt }] }], };
            if (systemPrompt) { payload.systemInstruction = { parts: [{ text: systemPrompt }] }; }
            try {
                const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                if (!response.ok) { throw new Error(`API Error: ${response.statusText}`); }
                const result = await response.json();
                return result.candidates[0].content.parts[0].text;
            } catch (error) {
                console.error("Gemini API call failed:", error);
                return "عذرًا، حدث خطأ أثناء التواصل مع الذكاء الاصطناعي. يرجى المحاولة مرة أخرى.";
            }
        }
        
        // --- RENDER FUNCTIONS ---
        function renderProducts() {
            productsGrid.innerHTML = products.map(product => {
                return `
                <div class="product-card rounded-lg shadow-lg overflow-hidden flex flex-col">
                    <img src="${product.image}" alt="${product.title}" class="w-full h-48 object-cover">
                    <div class="p-6 flex flex-col flex-grow">
                        <h2 class="text-2xl font-bold text-white mb-3">${product.title}</h2>
                        <div class="mb-4 flex-grow"><ul class="space-y-2 text-gray-300">${product.features.map(f => `<li class="flex items-center"><svg class="w-4 h-4 mr-2 ml-1 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>${f}</li>`).join('')}</ul></div>
                        <div class="mt-auto">
                           <p class="text-xs text-yellow-400 bg-yellow-900/40 p-2 rounded-md mb-4">${product.notes}</p>
                           <button onclick="openOrderModal('${product.id}')" class="w-full btn-primary text-white py-2.5 rounded-lg font-bold">اطلب الآن</button>
                        </div>
                    </div>
                </div>`;
            }).join('');
        }

        // --- AI MODAL LOGIC ---
        function openAiHelperModal() {
            aiModalTitle.textContent = '✨ مساعدك الذكي للاشتراكات';
            aiModalContent.innerHTML = `<p class="text-lg text-gray-300">أخبرني عن طبيعة عملك أو ما تريد إنجازه، وسأقترح عليك أفضل الاشتراكات التي تناسبك.</p>`;
            aiModalLoader.classList.add('hidden');
            aiModalFormContainer.classList.remove('hidden');
            aiUserPromptTextarea.value = '';
            aiHelperModal.classList.remove('hidden');
        }

        function closeAiHelperModal() {
            aiHelperModal.classList.add('hidden');
        }
        
        async function handleAiFormSubmit(event) {
            event.preventDefault();
            aiModalFormContainer.classList.add('hidden');
            aiModalContent.innerHTML = '';
            aiModalLoader.classList.remove('hidden');

            const userInput = aiUserPromptTextarea.value;
            if (!userInput) {
                aiModalContent.innerHTML = `<p class="text-red-400">الرجاء إدخال وصف لاحتياجاتك.</p>`;
                aiModalLoader.classList.add('hidden');
                aiModalFormContainer.classList.remove('hidden');
                return;
            }

            const productListString = products.map(p => `- ${p.title}: ${p.features.join(', ')}`).join('\n');
            const systemPrompt = "أنت خبير استشاري في الاشتراكات الرقمية. مهمتك هي مساعدة المستخدمين في اختيار الاشتراك الأنسب لاحتياجاتهم من القائمة المتاحة. قدم توصيتك في نقاط واضحة ومختصرة، مع شرح سبب اختيار كل منتج. تحدث باللغة العربية بأسلوب ودود ومساعد.";
            const prompt = `بناءً على قائمة المنتجات التالية:\n${productListString}\n\nما هو أفضل اشتراك لمستخدم يقول: '${userInput}'؟`;
            const response = await callGeminiAPI(prompt, systemPrompt);
            
            aiModalLoader.classList.add('hidden');
            aiModalContent.innerHTML = response.replace(/\n/g, '<br>');
        }

        // --- Order Modal Logic ---
        function openOrderModal(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                modalProductTitle.textContent = product.title;
                productNameInput.value = product.title;
                
                const selectedPackageText = document.getElementById('selected-package-text');
                const packageOptions = document.getElementById('package-options');
                const selectedPackageInput = document.getElementById('selected-package-input');

                packageOptions.innerHTML = '';
                packageOptions.classList.add('hidden');
                document.getElementById('dropdown-arrow').style.transform = 'rotate(0deg)';

                const defaultPackage = product.packages[0];
                const defaultPackageValue = `${defaultPackage.name} - ${defaultPackage.price}`;
                selectedPackageText.textContent = defaultPackageValue;
                selectedPackageInput.value = defaultPackageValue;

                product.packages.forEach(pkg => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'p-3 cursor-pointer hover:bg-gray-700 transition-colors duration-200';
                    const packageValue = `${pkg.name} - ${pkg.price}`;
                    optionDiv.innerHTML = `<span class="font-bold text-white">${pkg.name}</span><span class="text-green-400 float-left">${pkg.price}</span>`;
                    
                    optionDiv.addEventListener('click', () => {
                        selectedPackageText.textContent = packageValue;
                        selectedPackageInput.value = packageValue;
                        packageOptions.classList.add('hidden');
                        document.getElementById('dropdown-arrow').style.transform = 'rotate(0deg)';
                    });
                    packageOptions.appendChild(optionDiv);
                });
                
                orderModal.classList.remove("hidden");
            }
        }

        function closeOrderModal(){
            orderModal.classList.add("hidden");
            orderForm.reset();
        }

        function handleOrderSubmit(event){
            event.preventDefault();
            const productName = productNameInput.value;
            const selectedPackage = document.getElementById('selected-package-input').value;
            const customerName = document.getElementById("customer-name").value;
            const customerPhone = document.getElementById("customer-phone").value;
            const customerEmail = document.getElementById("customer-email").value;
            const customerNotes = document.getElementById("customer-notes").value;
            let message = `*طلب جديد من متجر وفرنهالك تك*\n\n`;
            message += `*المنتج:* ${productName}\n`;
            message += `*الباقة المطلوبة:* ${selectedPackage}\n`;
            message += `*الاسم:* ${customerName}\n`;
            message += `*رقم الواتساب:* ${customerPhone}\n`;
            if (customerEmail) message += `*الإيميل:* ${customerEmail}\n`;
            if (customerNotes) message += `*ملاحظات:* ${customerNotes}\n\n`;
            message += `برجاء تأكيد الطلب وتوضيح طرق الدفع المتاحة.`;
            const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, "_blank");
            closeOrderModal();
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            renderProducts();
            orderForm.addEventListener('submit', handleOrderSubmit);
            aiHelperForm.addEventListener('submit', handleAiFormSubmit);
            
            const packageButton = document.getElementById('package-button');
            const packageOptions = document.getElementById('package-options');
            const packageDropdown = document.getElementById('package-dropdown');
            const dropdownArrow = document.getElementById('dropdown-arrow');

            packageButton.addEventListener('click', (event) => {
                event.stopPropagation();
                const isHidden = packageOptions.classList.toggle('hidden');
                dropdownArrow.style.transform = isHidden ? 'rotate(0deg)' : 'rotate(180deg)';
            });

            document.addEventListener('click', (event) => {
                if (!packageDropdown.contains(event.target)) {
                    packageOptions.classList.add('hidden');
                    dropdownArrow.style.transform = 'rotate(0deg)';
                }
                 if (event.key === "Escape") {
                    if(!orderModal.classList.contains('hidden')) closeOrderModal();
                    if(!aiHelperModal.classList.contains('hidden')) closeAiHelperModal();
                }
            });
        });
    </script>
</body>
</html>

